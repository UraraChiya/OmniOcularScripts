<!--Author: UraraChiya-->
<!--Date: 2026/01/08-->
<!--Version: 1.7.10-->
<oo>
    <!-- Minecraft 实用函数 -->
    <init>
        function uuid2name(uuid) {
            /* 找不到更好的写法，只能写死了 */
            var names = {
                '80b99335-ad79-42ed-ab38-1d15bf2bac3e': 'shen_FNX',
                '669b5531-6e6c-4841-9a6d-76496e851739': 'Xudongwan',
                '34b7ce33-953f-4b7d-871b-6574e8c0c2c0': 'Leong123',
                '4fd78824-8b21-4a37-91fd-6159b153d481': 'Mgctz',
                '8db8031b-4fe8-4671-8c20-ffcd78c9c677': 'MDDyue'
            };
            return names[uuid.toLowerCase()] || uuid.split('-')[0];
        }

        function getItemSlot(Items, slot, slotName) {
            slotName = slotName || 'Slot';
            for (var i in Items) {
                if (Items[i][slotName] == slot) return Items[i];
            }
        }
    </init>
    <!-- 数学函数 -->
    <init>
        /* log 函数 */
        function log(base, n) {
            return Math.log(n) / Math.log(base);
        }
        function log2(n) {
            return Math.log(n) / Math.LN2;
        }
        function log10(n) {
            return Math.log(n) / Math.LN10;
        }
    </init>
    <!-- 格式化函数 -->
    <init>
        /* 三位分割整数 */
        function numberWithCommas(x) {
            return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');
        }

        /**
         * 补全任意字符 (ES5 兼容版)
         * @param {any} input - 原始输入
         * @param {number} targetLength - 目标长度
         * @param {string} padChar - 用于补全的字符 (默认为空格)
         * @returns {string}
         */
        function padStart(input, targetLength, padChar) {
            /* 1. 将输入转换为字符串，并处理 null/undefined */
            var str = input === null || input === undefined ? '' : input.toString();

            /* 2. 默认填充字符为单个空格，并确保 padChar 是字符串 */
            padChar = padChar === null || padChar === undefined ? ' ' : padChar.toString();

            /* 3. 如果当前长度已达到目标，或者 padChar 为空字符串，直接返回 */
            if (str.length >= targetLength || padChar.length === 0) {
                return str;
            }

            /* 4. 计算需要补全的长度 */
            var paddingNeeded = targetLength - str.length;
            var padding = '';

            /* 5. 循环拼接。注意：如果 padChar 是多个字符，这里可以进行截取或全量拼接 */
            while (padding.length < paddingNeeded) {
                padding += padChar;
            }

            /* 6. 截取多余的部分（防止 padChar 长度 > 1 时超过目标长度）并拼接返回 */
            return padding.substring(0, paddingNeeded) + str;
        }

        function padSpaces(input, targetLength) {
            return padStart(input, targetLength, ' ');
        }
        /* 格式化 SI 样式 */
        function formatSI(num) {
            if (num === 0) return '0';

            var absNum = Math.abs(num);

            /* 1. 小于 1000 时按原样输出 */
            if (absNum < 1000) {
                return num.toString();
            }

            var prefixes = ['', 'k', 'M', 'G', 'T', 'P', 'E'];

            /* 2. 直接调用你的 log 函数计算数量级 (以 1000 为底) */
            /* 假设你的 log 函数签名是 log(base, n) */
            var i = Math.floor(log(1000, absNum));
            var index = Math.min(i, prefixes.length - 1);

            var scaled = num / Math.pow(1000, index);

            /* 3. 格式化三位有效数字 */
            var formatted = scaled.toPrecision(3);

            /* 4. 进位补偿：处理 999.9 -> 1000 的情况 */
            if (Math.abs(parseFloat(formatted)) >= 1000 && index < prefixes.length - 1) {
                index++;
                scaled /= 1000;
                formatted = scaled.toPrecision(3);
            }

            /* 5. 修正科学计数法（ES5 兼容写法） */
            if (formatted.indexOf('e') !== -1) {
                formatted = parseFloat(formatted).toFixed(2);
            }

            return formatted + ' ' + prefixes[index];
        }
        /* 格式化 IEC 样式 */
        function formatIEC(num) {
            /* 1. 处理零的特殊情况 */
            if (num === 0) return '0';

            var absNum = Math.abs(num);

            /* 2. 对于小于 1024 的数字，按原样输出字符串（不补零） */
            if (absNum < 1024) {
                return num.toString();
            }

            /* 3. 定义 IEC 二进制词头列表 */
            var prefixes = ['', 'Ki', 'Mi', 'Gi', 'Ti', 'Pi', 'Ei'];

            /* 4. 使用自定义 log 函数计算以 1024 为底的数量级 */
            var i = Math.floor(log(1024, absNum));
            var index = Math.min(i, prefixes.length - 1);

            /* 5. 计算缩放后的数值 */
            var scaled = num / Math.pow(1024, index);

            /* 6. 核心：强制保留三位有效数字 */
            var formatted = scaled.toPrecision(3);

            /* 7. 进位补偿逻辑 */
            /* 例如：1023.9 可能会被 toPrecision(3) 四舍五入为 "1024" */
            /* 此时需要进位到下一个词头（如从 Ki 进到 Mi） */
            if (Math.abs(parseFloat(formatted)) >= 1024 && index < prefixes.length - 1) {
                index++;
                scaled /= 1024;
                formatted = scaled.toPrecision(3);
            }

            /* 8. 修正可能出现的科学计数法字符串（如 "1.00e+0"） */
            /* 使其保持 "1.00" 这种直观的格式 */
            if (formatted.indexOf('e') !== -1) {
                formatted = parseFloat(formatted).toFixed(2);
            }

            return formatted + ' ' + prefixes[index];
        }
        /* 对齐函数 */
        function formatAlignedSI(num) {
            /* 1.23 K 加上空格共 6 位 */
            return padSpaces(formatSI(num), 6);
        }
        function formatAlignedIEC(num) {
            /* 1.23 Ki 加上空格共 7 位，考虑到最大可能到 1023 Ki，建议设为 8 */
            return padSpaces(formatIEC(num), 8);
        }
    </init>
    <!-- 用于将字符串转成样式 -->
    <init>
        var FORMAT = {
            BLACK: BLACK,
            DBLUE: DBLUE,
            DGREEN: DGREEN,
            DAQUA: DAQUA,
            DRED: DRED,
            DPURPLE: DPURPLE,
            GOLD: GOLD,
            GRAY: GRAY,
            DGRAY: DGRAY,
            BLUE: BLUE,
            GREEN: GREEN,
            AQUA: AQUA,
            RED: RED,
            LPURPLE: LPURPLE,
            YELLOW: YELLOW,
            WHITE: WHITE,

            OBF: OBF,
            BOLD: BOLD,
            STRIKE: STRIKE,
            UNDER: UNDER,
            ITALIC: ITALIC,
            RESET: RESET
        };
    </init>
    <init>
        function customLabelFormat(label, text) {
            return YELLOW + label + ': ' + WHITE + text;
        }
    </init>
    <init>
        function convertSecondsToTime(seconds) {
            var results = [];

            /* 1. 处理天数 */
            var days = Math.floor(seconds / 86400);
            var remainingSeconds = seconds % 86400;
            if (days > 0) {
                results.push(days + 'd');
            }

            /* 2. 处理小时 */
            var hours = Math.floor(remainingSeconds / 3600);
            remainingSeconds %= 3600;
            if (days > 0 || hours > 0) {
                var hStr = days > 0 ? padStart(hours, 2, '0') : hours.toString();
                results.push(hStr + 'h');
            }

            /* 3. 处理分钟 */
            var minutes = Math.floor(remainingSeconds / 60);
            remainingSeconds %= 60;
            if (days > 0 || hours > 0 || minutes > 0) {
                var mStr = days > 0 || hours > 0 ? padStart(minutes, 2, '0') : minutes.toString();
                results.push(mStr + 'm');
            }

            /* 4. 处理秒数（核心修改点） */
            var sValue;
            /* 判断是否为小数：与自身取整后对比 */
            if (remainingSeconds % 1 !== 0) {
                /* 是小数，保留两位小数 */
                sValue = remainingSeconds.toFixed(2);
            } else {
                /* 是整数，保持原样 */
                sValue = remainingSeconds.toString();
            }

            /* 5. 秒数补位逻辑 */
            var sStr;
            if (days > 0 || hours > 0 || minutes > 0) {
                /* 如果前面有大单位，需要确保整数部分是两位数 */
                /* 先拆分小数点，只对整数部分补零，防止 padStart 干扰小数位 */
                var parts = sValue.split('.');
                var integerPart = padStart(parts[0], 2, '0');
                sStr = parts.length > 1 ? integerPart + '.' + parts[1] : integerPart;
            } else {
                /* 没有大单位，该几位就几位 */
                sStr = sValue;
            }

            results.push(sStr + 's');

            return results.join(' ');
        }

        /* 假设 tps 恒为 20 */
        function convertTicksToTime(ticks) {
            return convertSecondsToTime(ticks / 20);
        }
    </init>
    <!-- 设置显示样式 -->
    <setting id="displaynameTileentity">
        "|" + GREEN + "DISPLAYNAME" + ": " + WHITE+ "RETURN"
    </setting>
    <!--<setting id="displaynameTileentity">-->
        <!--YELLOW + "DISPLAYNAME" + " : "  + WHITE + "RETURN"-->
    <!--</setting>-->
</oo>